import{b as we}from"./chunk-P54KOG3W.js";import"./chunk-WIJPBQRI.js";import{A as O,C as T,L as v,M as ye,T as _e,V as ve,W as Ce,X as Se,Y as be,a as de,e as he,f as pe,h as ge,p as fe,q as ue,s as B,t as xe,y as R,z as U}from"./chunk-SNMWJJSU.js";import{a as me,g as ce}from"./chunk-FBJUKFYF.js";import{Ba as se,Ca as le,ba as X,ga as Z,ia as $,ma as ee,oa as te,pa as ie,ra as ne,sa as ae,wa as oe,xa as re,za as M}from"./chunk-GGZZIAUL.js";import{Ab as b,Ca as k,Da as C,Gb as d,Ic as A,Lb as w,Nb as Q,Ob as j,Pb as a,Qb as r,Rb as p,Sb as _,Ub as f,Vb as g,Yb as Y,Zb as G,a as K,cb as H,gb as l,gc as i,hc as h,ic as z,lc as q,mc as V,nc as D,pa as u,qa as x,sc as P,tb as S}from"./chunk-PZT3DLUM.js";function qe(s,c){if(s&1){let e=_();a(0,"mb-line-style-selector",3),f("selectionChange",function(t){u(e);let n=g();return x(n.updateStyle(t))}),r()}if(s&2){let e=g();d("initial",e.current.style)("label","Line")}}var Me=(()=>{class s{constructor(){this.initial=C.required(),this.removed=k(),this.changed=k(),A(()=>{this.current=this.initial()})}updateStyle(e){this.current.style=e,this.changed.emit(this.current)}updateParams(e){this.current.params=e,this.changed.emit(this.current)}remove(){this.removed.emit(this.current)}static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275cmp=S({type:s,selectors:[["app-t3ema-params"]],inputs:{initial:[1,"initial"]},outputs:{removed:"removed",changed:"changed"},decls:6,vars:2,consts:[["mat-icon-button","","color","warn",3,"click"],[3,"selectionChange","initial"],[3,"initial","label"],[3,"selectionChange","initial","label"]],template:function(o,t){o&1&&(a(0,"div")(1,"button",0),f("click",function(){return t.remove()}),a(2,"mat-icon"),i(3,"delete"),r()(),a(4,"mb-t3-exponential-moving-average-params",1),f("selectionChange",function(m){return t.updateParams(m)}),r(),b(5,qe,1,2,"mb-line-style-selector",2),r()),o&2&&(l(4),d("initial",t.current.params),l(),w(t.current.showStyle?5:-1))},dependencies:[M,le,be,ye],encapsulation:2,changeDetection:0})}}return s})();var Ve=(s,c)=>c.id;function De(s,c){if(s&1){let e=_();a(0,"app-t3ema-params",2),f("changed",function(t){u(e);let n=g();return x(n.updated(t))})("removed",function(t){u(e);let n=g();return x(n.removed(t))}),r()}if(s&2){let e=c.$implicit;d("initial",e)}}var Le=s=>"length"in s,ke=()=>{let s=new Se;return s.color="",s.width=1.5,s.dash="",s.interpolation="camullRom",s},Te=(s,c,e,o,t,n)=>({id:s,params:{length:e,vFactor:o,firstIsAverage:t,barComponent:n},style:ke(),showStyle:c}),Ne=(s,c,e,o,t)=>({id:s,params:{smoothingFactor:e,vFactor:o,barComponent:t},style:ke(),showStyle:c});function J(s){return s===1e3?0:1e3}var Pe=(()=>{class s{constructor(){this.initialLength=C(),this.initialSmoothingFactor=C(),this.colors=C(),this.changed=k(),this.t3emaArray=[],this.colorArray=["#ff0000"],this.startId=0,this.initialized=!1,A(()=>{let e=this.initialLength();if(e){this.startId=J(this.startId);let o=this.startId,t=[];for(let n=0;n<e.length.length;n++){let m=Te(o+n,e.showStyle,e.length[n],e.vFactor,e.firstIsAverage,e.barComponent);m.style.color=this.colorArray[n%this.colorArray.length],t.push(m)}this.t3emaArray=t,this.defaultBarComponent=e.barComponent}}),A(()=>{let e=this.initialSmoothingFactor();if(e){this.startId=J(this.startId);let o=this.startId,t=[];for(let n=0;n<e.smoothingFactor.length;n++){let m=Ne(o+n,e.showStyle,e.smoothingFactor[n],e.vFactor,e.barComponent);m.style.color=this.colorArray[n%this.colorArray.length],t.push(m)}this.t3emaArray=t,this.defaultBarComponent=e.barComponent}}),A(()=>{let e=this.colors();if(e&&e.length>0){this.startId=J(this.startId);let o=this.startId,t=[];this.colorArray=e;for(let n=0;n<this.t3emaArray.length;n++){let m=K({},this.t3emaArray[n]);m.style.color=e[n%e.length],m.id=o+n,t.push(m)}this.t3emaArray=t}})}ngAfterViewInit(){this.initialized=!0,this.changed.emit(this.t3emaArray)}add(){let e=this.getShowStyle(),o=Te(this.startId+this.t3emaArray.length,e,this.getLastLength()+5,.7,!0,this.defaultBarComponent);e&&(o.style.color=this.colorArray[this.t3emaArray.length%this.colorArray.length]),this.t3emaArray.push(o),this.t3emaArray=[...this.t3emaArray],this.notify()}updated(e){this.getIndex(e)>=0&&this.notify()}removed(e){let o=this.getIndex(e);if(o>=0){this.t3emaArray.splice(o,1);let t=this.startId;for(let n=o;n<this.t3emaArray.length;++n)this.t3emaArray[n].id=t+n;this.t3emaArray=[...this.t3emaArray],this.notify()}}getLastLength(){let e=this.t3emaArray.length-1;if(e<0)return 0;if(Le(this.t3emaArray[e].params))return this.t3emaArray[e].params.length;{let o=this.t3emaArray[e].params;return Math.ceil(2/o.smoothingFactor-1)}}getShowStyle(){return this.t3emaArray.length<=0?!1:this.t3emaArray[0].showStyle}getIndex(e){for(let o=0;o<this.t3emaArray.length;o++)if(this.t3emaArray[o]===e)return o;return-1}notify(){this.initialized&&this.changed.emit(this.t3emaArray)}static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275cmp=S({type:s,selectors:[["app-t3ema-list"]],inputs:{initialLength:[1,"initialLength"],initialSmoothingFactor:[1,"initialSmoothingFactor"],colors:[1,"colors"]},outputs:{changed:"changed"},decls:6,vars:0,consts:[[3,"initial"],["mat-mini-fab","","color","primary",3,"click"],[3,"changed","removed","initial"]],template:function(o,t){o&1&&(Q(0,De,1,1,"app-t3ema-params",0,Ve),a(2,"div")(3,"button",1),f("click",function(){return t.add()}),a(4,"mat-icon"),i(5,"add"),r()()()),o&2&&j(t.t3emaArray)},dependencies:[M,se,Me],encapsulation:2,changeDetection:0})}}return s})();var L=(s,c,e)=>[s,c,e];function We(s,c){if(s&1){let e=_();a(0,"mat-expansion-panel",5)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon"),i(4,"tune"),r()()(),a(5,"mb-swatches-select",16),f("selectionChange",function(t){u(e);let n=g();return x(n.indicatorPaletteChanged(t))}),r(),a(6,"app-t3ema-list",17),f("changed",function(t){u(e);let n=g();return x(n.indicatorsChanged(t))}),r()()}if(s&2){let e=g();l(5),d("selected",e.selectedIndex)("colors",e.palettes)("label","Palette"),l(),d("initialLength",e.initialIndicators)("colors",e.selectedPalette)}}function He(s,c){if(s&1&&(a(0,"span"),p(1,"a",18),i(2),r()),s&2){let e=g();l(),Y("href",e.dataSelection.url,H),l(),h(e.dataSelection.urlName)}}function ze(s,c){if(s&1){let e=_();a(0,"mat-expansion-panel",5)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon"),i(4,"tune"),r()()(),a(5,"mat-form-field",19)(6,"mat-label"),i(7,"Max period to display"),r(),a(8,"input",20),D("ngModelChange",function(t){u(e);let n=g();return V(n.maxPeriod,t)||(n.maxPeriod=t),x(t)}),r()(),a(9,"mat-form-field",19)(10,"mat-label"),i(11,"Height"),r(),a(12,"input",21),D("ngModelChange",function(t){u(e);let n=g();return V(n.freqsH,t)||(n.freqsH=t),x(t)}),r()(),a(13,"app-t3ema-list",22),f("changed",function(t){u(e);let n=g();return x(n.freqsChanged(t))}),r()()}if(s&2){let e=g();l(8),q("ngModel",e.maxPeriod),l(4),q("ngModel",e.freqsH),l(),d("initialLength",e.initialFreqs)}}var Be=!1,E=4096,Ee=10,Ie=90,Fe=1,N=32,Re=s=>"length"in s,Ue=(s,c,e)=>{let o=[],t=U(e);for(let n of s)o.push({time:n.time,value:c.update(t(n))});return o},Oe=(s,c,e)=>{let o=U(e),t=o(s[0]);for(;!c.isPrimed;)c.update(t);let n=[];for(let m of s)n.push({time:m.time,value:c.update(o(m))});return n},Je=()=>({width:"100%",widthMin:360,navigationPane:{height:30,heightMin:30,heightMax:30,hasLine:!1,hasArea:!0,hasTimeAxis:!1,timeTicks:0},heightNavigationPane:30,timeAnnotationFormat:"%Y-%m-%d",axisLeft:!0,axisRight:!1,margin:{left:0,top:10,right:20,bottom:0},ohlcv:{name:"",data:[],candlesticks:!1},pricePane:{height:"30%",heightMin:300,heightMax:800,valueMarginPercentageFactor:.01,valueFormat:",.2f",bands:[],lineAreas:[],horizontals:[],arrows:[],lines:[]},indicatorPanes:[],crosshair:!1,volumeInPricePane:!1,menuVisible:!0,downloadSvgVisible:!0}),wt=(()=>{class s{constructor(){this.indicators=[],this.initialized=!1,this.selectedIndex=0,this.initialIndicators={length:[2,4,6],vFactor:.7,firstIsAverage:!1,barComponent:R.Median,showStyle:!0},this.initialFreqs={length:[2,4,6],vFactor:.7,firstIsAverage:!1,showStyle:!1},this.palettes=B(this.initialIndicators.length.length),this.selectedPalette=this.palettes[this.selectedIndex],this.emaNote=ce,this.t3emaNote=me,this.freqs=[],this.freqsMaxPeriod=40,this.freqsHeight=300,this.unlocked=!0,this.dataStepUp=O(Ee,N,Ie,N*3,Fe),this.dataStepDn=O(Ie,N,Ee,N*3,Fe),this.t3ema2=T.calculate(E,new v({length:2,vFactor:.7,firstIsAverage:!1}),4),this.t3ema4=T.calculate(E,new v({length:4,vFactor:.7,firstIsAverage:!1}),6),this.t3ema6=T.calculate(E,new v({length:6,vFactor:.7,firstIsAverage:!1}),8)}get maxPeriod(){return this.freqsMaxPeriod}set maxPeriod(e){(!e||e<2)&&(e=2),this.freqsMaxPeriod=e,this.freqs.length>0&&(this.freqs=[...this.freqs])}get freqsH(){return this.freqsHeight}set freqsH(e){this.freqsHeight=e,this.freqs.length>0&&(this.freqs=[...this.freqs])}get unLocked(){return this.unlocked}set unLocked(e){this.unlocked=e,this.render()}ngAfterViewInit(){this.initialized=!0,this.unlocked=Be,this.render()}indicatorPaletteChanged(e){this.selectedIndex=this.palettes.indexOf(e),this.selectedPalette=e}indicatorsChanged(e){let o=e.length>2?e.length:2;o!==this.selectedPalette.length&&(this.palettes=B(o),this.selectedIndex>=o&&(this.selectedIndex=0),this.selectedPalette=this.palettes[this.selectedIndex]),this.indicators=e,this.render()}freqsChanged(e){let o=[];for(let t of e)if(Re(t.params)){let n=t.params,m=T.calculate(E,new v({length:n.length,vFactor:n.vFactor,firstIsAverage:n.firstIsAverage}),n.length*2);o.push(m)}else{let n=t.params,m=Math.ceil(2/n.smoothingFactor-1),I=T.calculate(E,new v({smoothingFactor:n.smoothingFactor,vFactor:n.vFactor}),m*2);o.push(I)}this.freqs=o}dataSelectionChanged(e){this.dataSelection=e,this.render()}render(){this.initialized&&(this.configuration=this.prepareConfig(this.dataSelection.mnemonic,this.dataSelection.data,!1),this.configurationStepUp=this.prepareConfig("",this.dataStepUp,!0),this.configurationStepDn=this.prepareConfig("",this.dataStepDn,!0))}prepareConfig(e,o,t){let n=Je();n.menuVisible=this.unlocked,n.ohlcv.name=e,n.ohlcv.data=o;for(let m of this.indicators){let I=m.params.barComponent?m.params.barComponent:R.Close,W=new v(m.params),y=new ve;y.name=W.getMnemonic(),y.data=t?Oe(o,W,I):Ue(o,W,I);let F=m.style;y.color=F.color,y.width=F.width,y.dash=F.dash,y.interpolation=F.interpolation,n.pricePane.lines.push(y)}return n}static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275cmp=S({type:s,selectors:[["app-ind-t3ema"]],decls:136,vars:96,consts:[[1,"slide-toggle",3,"ngModelChange","color","ngModel"],[1,"icon"],["label","",3,"selectionChange"],[1,"figwide"],[1,"ohlcv-chart-study",3,"configuration"],["expanded","false",2,"margin-bottom","1em"],[2,"width","100%"],[3,"href"],[3,"subfig","width","height","ymode","xmode","maxPeriod","data","settingsPanelVisible"],[3,"subfig","width","height","ymode","xmode","maxPeriod","minDeg","maxDeg","data","settingsPanelVisible"],[3,"subfig","width","height","ymode","xmode","data","settingsPanelVisible"],[3,"subfig","width","height","ymode","xmode","minDeg","maxDeg","data","settingsPanelVisible"],[1,"counter-skip"],["href","https://books.google.com/books?id=JokQD5nK4LMC","target","_blank"],["href","https://books.google.com/books?id=q9Q6EAAAQBAJ","target","_blank"],["href","https://books.google.com/books?id=EaMuAAAAQBAJ","target","_blank"],[2,"vertical-align","bottom",3,"selectionChange","selected","colors","label"],[3,"changed","initialLength","colors"],["target","_blank",3,"href"],["appearance","fill"],["matInput","","type","number","min","8","max","1024","step","1",3,"ngModelChange","ngModel"],["matInput","","type","number","min","100","max","1024","step","1",3,"ngModelChange","ngModel"],[3,"changed","initialLength"]],template:function(o,t){o&1&&(a(0,"h1"),i(1),r(),a(2,"mat-slide-toggle",0),D("ngModelChange",function(m){return V(t.unLocked,m)||(t.unLocked=m),m}),a(3,"mat-icon",1),i(4,"tune"),r()(),a(5,"app-bar-series-select",2),f("selectionChange",function(m){return t.dataSelectionChanged(m)}),r(),a(6,"figure",3),p(7,"mb-ohlcv-chart",4),b(8,We,7,5,"mat-expansion-panel",5),a(9,"figcaption"),i(10),b(11,He,3,2,"span"),r()(),a(12,"div",6),i(13," An exponential moving average (WMA) of length "),a(14,"mb-ki"),i(15,"l \\ge 2"),r(),i(16," is the arithmetic mean of the last "),a(17,"mb-ki"),i(18,"l"),r(),i(19," observations of a series "),a(20,"mb-ki"),i(21),r(),i(22,", where "),a(23,"mb-ki"),i(24),r(),i(25," is the most recent value and "),a(26,"mb-ki"),i(27,"k \\ge l"),r(),i(28,": "),a(29,"mb-kd"),i(30),r(),i(31," Close to the "),a(32,"a",7),i(33,"Simple Moving Average"),r(),i(34,", but multiplier coefficients are not constant across the window width but are linearly weighted. "),a(35,"mb-kd"),i(36),r(),i(37," The sum of the data and coefficient products are divided by the sum of coefficients to normalize the averaging process. The major advantage of WMA is the reduced lag which results from the most recent data being the most heavily weighted. WMA coefficients form triangle across the width of the filter, resulting a center of gravity being "),a(38,"mb-ki"),i(39),r(),i(40," across the window. "),p(41,"p"),i(42," From the digital signal processing (DSP) point of view, T3EMA is a finite impulse response (FIR) filter with all "),a(43,"mb-ki"),i(44),r(),i(45," weight coefficients equal: "),a(46,"mb-kd"),i(47),r(),i(48," The filter is finite because only a finite number of "),a(49,"mb-ki"),i(50),r(),i(51," last samples contribute to its value. "),p(52,"p"),r(),a(53,"h2"),i(54,"Step response"),r(),i(55,`
Two figures below demonstrate the response to the step-up and step-down data.
The transition is clearly not linear.
The step-up response doesn't overshoot and the step-down response doesn't undershoot the data. `),a(56,"figure",3),p(57,"mb-ohlcv-chart",4),a(58,"figcaption"),i(59,"Step-up response."),r()(),a(60,"figure",3),p(61,"mb-ohlcv-chart",4),a(62,"figcaption"),i(63,"Step-down response."),r()(),a(64,"h2"),i(65,"Frequency response"),r(),a(66,"div",6),i(67," The figure below shows an amplitude and a phase lag of the unit sample response of a T3EMA as a function of a period of various signal frequencies. "),p(68,"p"),i(69," A period is a duration of a cycle in samples. The smallest possible period of a cycle is "),a(70,"mb-ki"),i(71),r(),i(72," samples. To understand this, imagine a cycle of a sinusoid which starts at zero, goes up and peaks at "),a(73,"mb-ki"),i(74),r(),i(75,", continues down and bottoms at "),a(76,"mb-ki"),i(77),r(),i(78,", and then returns back to zero. We need at least two samples (peak and through) to represent a cycle. "),p(79,"p"),r(),a(80,"figure",3),p(81,"mb-frequency-response-chart",8)(82,"mb-frequency-response-chart",9),b(83,ze,14,3,"mat-expansion-panel",5),a(84,"figcaption"),i(85,"An amplitude (a) and a phase lag (b) as a function of a period of a cycle."),r()(),a(86,"div",6),i(87," A period ("),a(88,"mb-ki"),i(89),r(),i(90,") is an inverse of the cycle's frequency ("),a(91,"mb-ki"),i(92),r(),i(93,"): "),a(94,"mb-ki"),i(95),r(),i(96,". The smallest period "),a(97,"mb-ki"),i(98),r(),i(99," corresponds to the Nyquist frequency "),a(100,"mb-ki"),i(101),r(),i(102," which is the highest frequency possible in a signal. "),r(),a(103,"figure",3),p(104,"mb-frequency-response-chart",8)(105,"mb-frequency-response-chart",10),a(106,"figcaption"),i(107,"An amplitude as a function of a period of a cycle (a) and as a function of a normalized frequency of a cycle (b) for various T3EMA lengths."),r()(),a(108,"figure",3),p(109,"mb-frequency-response-chart",9)(110,"mb-frequency-response-chart",11),a(111,"figcaption"),i(112,"A phase as a function of a period of a wave (a) and as a function of a normalized frequency of a wave for various T3EMA lengths."),r()(),p(113,"p")(114,"div",6)(115,"hr"),a(116,"h2",12),i(117,"References"),r(),a(118,"div"),i(119," Jeffrey, A., & Dai, H. H. (2008). "),a(120,"em"),i(121,"Handbook of mathematical formulas and integrals"),r(),i(122,". (4th ed., p. 592). San Diego, CA: Elsevier/Academic Press. "),p(123,"a",13),r(),a(124,"div"),i(125,"Mak, D. K. (2021). "),a(126,"em"),i(127,"Trading Tactics in the Financial Market: Mathematical Methods to Improve Performance"),r(),i(128," (p. ix+269). doi:10.1007/978-3-030-70622-7 "),p(129,"a",14),r(),a(130,"div"),i(131,"Oppenheim, A. V., Schafer, R. W., Yoder, M. A., & Padgett, W. T. (2009). "),a(132,"em"),i(133,"Discrete-time signal processing"),r(),i(134,". (3rd ed., p. 1120). Upper Saddle River, NJ: Pearson. "),p(135,"a",15),r()),o&2&&(l(),h(t.t3emaNote.title),l(),d("color","primary"),q("ngModel",t.unLocked),l(5),d("configuration",t.configuration),l(),w(t.unlocked?8:-1),l(2),z("",t.dataSelection.description,". "),l(),w(t.dataSelection.url?11:-1),l(10),h("x_{1},\\, x_{2},\\, x_{3},\\,\\ldots\\,,\\, x_{k}"),l(3),h("x_{k}"),l(6),h("\\tag*{(1)}y_{k}=\\frac{1}{l}\\sum_{m=k-l+1}^{k}x_{m}"),l(2),G("href","/",t.emaNote.route,"",H),l(4),h("\\tag*{}WMA_N = \\frac{\\sum\\limits_{i=0}^{N-1}{(N-i)P_i}}{\\sum\\limits_{i=0}^{N-1}{(N-i)}}"),l(3),h("\\frac{1}{3}"),l(5),h("l"),l(3),z(" ","\\tag*{(3)}y_{k}=\\sum_{m=0}^{l-1}c_{m}x_{k-m},\\ k\\ge l,\\ \\forall m\\ c_{m}=\\frac{1}{l}"," "),l(3),h("l"),l(7),d("configuration",t.configurationStepUp),l(4),d("configuration",t.configurationStepDn),l(10),h("2"),l(3),h("1"),l(3),h("-1"),l(4),d("subfig","(a)")("width","100%")("height",t.freqsH)("ymode","amplitudePct")("xmode","period")("maxPeriod",t.maxPeriod)("data",t.freqs)("settingsPanelVisible",t.unlocked),l(),d("subfig","(b)")("width","100%")("height",t.freqsH)("ymode","phaseDeg")("xmode","period")("maxPeriod",t.maxPeriod)("minDeg",-180)("maxDeg",180)("data",t.freqs)("settingsPanelVisible",t.unlocked),l(),w(t.unlocked?83:-1),l(6),h("\\tau"),l(3),h("\\nu"),l(3),h("\\tau = \\frac{1}{\\nu}"),l(3),h("\\tau = 2"),l(3),h("\\nu = \\frac{1}{\\tau} = \\frac{1}{2}"),l(3),d("subfig","(a)")("width","100%")("height",200)("ymode","amplitudePct")("xmode","period")("maxPeriod",15)("data",P(80,L,t.t3ema2,t.t3ema4,t.t3ema6))("settingsPanelVisible",t.unlocked),l(),d("subfig","(b)")("width","100%")("height",200)("ymode","amplitudePct")("xmode","frequency")("data",P(84,L,t.t3ema2,t.t3ema4,t.t3ema6))("settingsPanelVisible",t.unlocked),l(4),d("subfig","(a)")("width","100%")("height",200)("ymode","phaseDeg")("xmode","period")("maxPeriod",15)("minDeg",-100)("maxDeg",100)("data",P(88,L,t.t3ema2,t.t3ema4,t.t3ema6))("settingsPanelVisible",t.unlocked),l(),d("subfig","(b)")("width","100%")("height",200)("ymode","phaseDeg")("xmode","frequency")("minDeg",-100)("maxDeg",100)("data",P(92,L,t.t3ema2,t.t3ema4,t.t3ema6))("settingsPanelVisible",t.unlocked))},dependencies:[oe,$,ie,ee,ae,ne,te,Z,X,re,M,de,he,pe,ge,we,Ce,xe,ue,fe,_e,Pe],styles:[".ohlcv-chart-study[_ngcontent-%COMP%]{margin:0;padding:0}.button[_ngcontent-%COMP%]{margin-right:8px}.slide-toggle[_ngcontent-%COMP%]{float:right;margin:0 8px 0 0}.icon[_ngcontent-%COMP%]{vertical-align:bottom}"],changeDetection:0})}}return s})();export{wt as T3emaComponent};
